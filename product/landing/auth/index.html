<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In - JOCHero</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%231E40AF' rx='15' width='100' height='100'/><text y='70' x='50' text-anchor='middle' font-size='50' fill='white'>üìê</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-900 via-slate-900 to-blue-950 flex items-center justify-center p-4">
    
    <div class="w-full max-w-md">
        <!-- Logo -->
        <div class="text-center mb-8">
            <a href="/" class="inline-flex items-center gap-3">
                <span class="text-4xl">üìê</span>
                <span class="text-2xl font-bold text-white">JOCHero</span>
                <span class="px-2 py-0.5 bg-gradient-to-r from-yellow-400 to-orange-400 text-gray-900 text-xs font-bold rounded">BETA</span>
            </a>
        </div>

        <!-- Auth Card -->
        <div class="glass rounded-2xl p-8">
            <!-- Tabs -->
            <div class="flex mb-6 bg-white/5 rounded-lg p-1">
                <button onclick="showTab('signin')" id="tab-signin" class="flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all bg-blue-600 text-white">
                    Sign In
                </button>
                <button onclick="showTab('signup')" id="tab-signup" class="flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all text-white/60 hover:text-white">
                    Create Account
                </button>
            </div>

            <!-- Sign In Form -->
            <form id="form-signin" onsubmit="handleSignIn(event)">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-white/80 mb-1">Email</label>
                        <input 
                            type="email" 
                            id="signin-email"
                            required
                            class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"
                            placeholder="you@company.com"
                        >
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-white/80 mb-1">Password</label>
                        <input 
                            type="password" 
                            id="signin-password"
                            required
                            class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"
                            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                        >
                    </div>
                </div>

                <div id="signin-error" class="hidden mt-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg text-red-300 text-sm"></div>

                <button type="submit" id="signin-btn" class="w-full mt-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-all flex items-center justify-center gap-2">
                    <span>Sign In</span>
                    <span>‚Üí</span>
                </button>

                <p class="text-center text-white/50 text-sm mt-4">
                    <a href="#" class="text-blue-400 hover:text-blue-300">Forgot password?</a>
                </p>
            </form>

            <!-- Sign Up Form -->
            <form id="form-signup" class="hidden" onsubmit="handleSignUp(event)">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-white/80 mb-1">Full Name</label>
                        <input 
                            type="text" 
                            id="signup-name"
                            required
                            class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"
                            placeholder="John Smith"
                        >
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-white/80 mb-1">Email</label>
                        <input 
                            type="email" 
                            id="signup-email"
                            required
                            class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"
                            placeholder="you@company.com"
                        >
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-white/80 mb-1">Company <span class="text-white/40">(optional)</span></label>
                        <input 
                            type="text" 
                            id="signup-company"
                            class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"
                            placeholder="ABC Construction"
                        >
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-white/80 mb-1">Password</label>
                        <input 
                            type="password" 
                            id="signup-password"
                            required
                            minlength="8"
                            class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"
                            placeholder="Min 8 characters"
                        >
                    </div>
                </div>

                <div id="signup-error" class="hidden mt-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg text-red-300 text-sm"></div>
                <div id="signup-success" class="hidden mt-4 p-3 bg-green-500/20 border border-green-500/50 rounded-lg text-green-300 text-sm"></div>

                <button type="submit" id="signup-btn" class="w-full mt-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-all flex items-center justify-center gap-2">
                    <span>Create Account</span>
                    <span>‚Üí</span>
                </button>

                <p class="text-center text-white/50 text-sm mt-4">
                    By signing up, you agree to our 
                    <a href="#" class="text-blue-400 hover:text-blue-300">Terms</a> and 
                    <a href="#" class="text-blue-400 hover:text-blue-300">Privacy Policy</a>
                </p>
            </form>
        </div>

        <!-- Demo Access -->
        <div class="mt-6 text-center">
            <p class="text-white/50 text-sm mb-2">Just want to try it out?</p>
            <a href="/app" class="inline-flex items-center gap-2 text-blue-400 hover:text-blue-300 font-medium">
                <span>üéÆ</span> Launch Demo (No Account Needed)
            </a>
        </div>

        <!-- Back to Home -->
        <div class="mt-8 text-center">
            <a href="/" class="text-white/40 hover:text-white/60 text-sm">‚Üê Back to JOCHero.com</a>
        </div>
    </div>

    <script>
        const API_URL = 'https://web-production-309c2.up.railway.app';

        function showTab(tab) {
            const signinTab = document.getElementById('tab-signin');
            const signupTab = document.getElementById('tab-signup');
            const signinForm = document.getElementById('form-signin');
            const signupForm = document.getElementById('form-signup');

            if (tab === 'signin') {
                signinTab.classList.add('bg-blue-600', 'text-white');
                signinTab.classList.remove('text-white/60');
                signupTab.classList.remove('bg-blue-600', 'text-white');
                signupTab.classList.add('text-white/60');
                signinForm.classList.remove('hidden');
                signupForm.classList.add('hidden');
                document.title = 'Sign In - JOCHero';
            } else {
                signupTab.classList.add('bg-blue-600', 'text-white');
                signupTab.classList.remove('text-white/60');
                signinTab.classList.remove('bg-blue-600', 'text-white');
                signinTab.classList.add('text-white/60');
                signupForm.classList.remove('hidden');
                signinForm.classList.add('hidden');
                document.title = 'Create Account - JOCHero';
            }
        }

        async function handleSignIn(e) {
            e.preventDefault();
            const btn = document.getElementById('signin-btn');
            const errorEl = document.getElementById('signin-error');
            
            const email = document.getElementById('signin-email').value;
            const password = document.getElementById('signin-password').value;

            btn.innerHTML = '<span class="animate-pulse">Signing in...</span>';
            btn.disabled = true;
            errorEl.classList.add('hidden');

            try {
                const res = await fetch(`${API_URL}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });

                const data = await res.json();

                if (!res.ok) {
                    throw new Error(data.message || 'Invalid email or password');
                }

                // Store auth data
                localStorage.setItem('jochero_token', data.token);
                localStorage.setItem('jochero_user', JSON.stringify(data.user));

                // Redirect to dashboard
                window.location.href = '/dashboard';
            } catch (err) {
                errorEl.textContent = err.message;
                errorEl.classList.remove('hidden');
                btn.innerHTML = '<span>Sign In</span><span>‚Üí</span>';
                btn.disabled = false;
            }
        }

        async function handleSignUp(e) {
            e.preventDefault();
            const btn = document.getElementById('signup-btn');
            const errorEl = document.getElementById('signup-error');
            const successEl = document.getElementById('signup-success');

            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            const company = document.getElementById('signup-company').value;
            const password = document.getElementById('signup-password').value;

            btn.innerHTML = '<span class="animate-pulse">Creating account...</span>';
            btn.disabled = true;
            errorEl.classList.add('hidden');
            successEl.classList.add('hidden');

            try {
                const res = await fetch(`${API_URL}/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, company, password })
                });

                const data = await res.json();

                if (!res.ok) {
                    throw new Error(data.message || 'Registration failed');
                }

                // Store auth data
                localStorage.setItem('jochero_token', data.token);
                localStorage.setItem('jochero_user', JSON.stringify(data.user));

                // Show success and redirect
                successEl.textContent = '‚úì Account created! Redirecting...';
                successEl.classList.remove('hidden');
                
                setTimeout(() => {
                    window.location.href = '/dashboard';
                }, 1000);
            } catch (err) {
                errorEl.textContent = err.message;
                errorEl.classList.remove('hidden');
                btn.innerHTML = '<span>Create Account</span><span>‚Üí</span>';
                btn.disabled = false;
            }
        }

        // Check if already logged in
        const token = localStorage.getItem('jochero_token');
        if (token) {
            window.location.href = '/dashboard';
        }

        // Handle URL params for tab selection
        const params = new URLSearchParams(window.location.search);
        if (params.get('tab') === 'signup') {
            showTab('signup');
        }
    </script>
</body>
</html>
